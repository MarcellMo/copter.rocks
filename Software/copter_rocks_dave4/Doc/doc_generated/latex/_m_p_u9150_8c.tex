\hypertarget{_m_p_u9150_8c}{}\section{M\+P\+U9150.\+c File Reference}
\label{_m_p_u9150_8c}\index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
{\ttfamily \#include \char`\"{}M\+P\+U9150.\+h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{_m_p_u9150_8c_aa9d3f4102d6c3dacb07fd0da57a649cb}{M\+P\+U9150\+\_\+\+Setup} (void)
\begin{DoxyCompactList}\small\item\em gets increased when the mpu sends new data \end{DoxyCompactList}\item 
void \hyperlink{_m_p_u9150_8c_afad3e4f9d9238da5ffde49b155d9e457}{M\+P\+U9150\+\_\+\+Init} (void)
\begin{DoxyCompactList}\small\item\em Initialises the M\+PU and configures gyro and accelerometer. \end{DoxyCompactList}\item 
void \hyperlink{_m_p_u9150_8c_a0c49498e2784ee40fe0d7b4766abbfdb}{M\+P\+U9150\+\_\+\+Init\+A\+K8975A} (float $\ast$destination)
\begin{DoxyCompactList}\small\item\em initals 3 axis magnetometer \end{DoxyCompactList}\item 
void \hyperlink{_m_p_u9150_8c_ab2137323c677e007dc23af3982d0d70b}{M\+P\+U9150\+\_\+\+Calibrate} (void)
\begin{DoxyCompactList}\small\item\em calibrates the M\+PU \end{DoxyCompactList}\item 
bool \hyperlink{_m_p_u9150_8c_a80e8e31ece39826744afca452c8f84f4}{M\+P\+U9150\+\_\+\+Self\+Test} (void)
\begin{DoxyCompactList}\small\item\em Self test for the M\+PU. \end{DoxyCompactList}\item 
void \hyperlink{_m_p_u9150_8c_a03e83f5eaf88f5eb3a73d9c9179552ea}{get\+Gres} (void)
\begin{DoxyCompactList}\small\item\em sets g\+Res variable for calculating gyro value \end{DoxyCompactList}\item 
void \hyperlink{_m_p_u9150_8c_a8576aaf6260747651cb99775519156d4}{get\+Ares} (void)
\begin{DoxyCompactList}\small\item\em sets Ares variable for calculating accelerometer value \end{DoxyCompactList}\item 
uint16\+\_\+t \hyperlink{_m_p_u9150_8c_ad139c70ad8fe17edf3bbbfa7f74db13e}{Get\+Sensor\+Count} (void)
\begin{DoxyCompactList}\small\item\em getter for Sensor\+Count \end{DoxyCompactList}\item 
void \hyperlink{_m_p_u9150_8c_affccf93aa2c7445f501003cb3c7ec823}{Get\+Angles} (float $\ast$angles)
\begin{DoxyCompactList}\small\item\em calculates angles \end{DoxyCompactList}\item 
void \hyperlink{_m_p_u9150_8c_aba6353e685d53cdbbaaddba7390283c3}{Get\+Mag\+Data} (float $\ast$pt)
\begin{DoxyCompactList}\small\item\em getter for magnetic data \end{DoxyCompactList}\item 
void \hyperlink{_m_p_u9150_8c_aa71d315bcdb1b9323329962a481a1490}{Get\+Gyro\+Data} (float $\ast$pt)
\begin{DoxyCompactList}\small\item\em getter for gyro data \end{DoxyCompactList}\item 
void \hyperlink{_m_p_u9150_8c_a05f6f2f09b0d64f157081650ac411271}{Get\+Acc\+Data} (float $\ast$pt)
\begin{DoxyCompactList}\small\item\em getter for acceleration data \end{DoxyCompactList}\item 
void \hyperlink{_m_p_u9150_8c_a2ae2ee3ce9369114b232aba97d813ddd}{M\+P\+U9\+X50\+\_\+\+Ext\+\_\+\+Int\+\_\+\+I\+SR} (void)
\begin{DoxyCompactList}\small\item\em Interrupt service routine of the externel M\+PU interrupt. \end{DoxyCompactList}\item 
void \hyperlink{_m_p_u9150_8c_a812d10f594dfdeeab08734a739102717}{transformation} (float $\ast$values)
\begin{DoxyCompactList}\small\item\em Transformation for M\+PU values. \end{DoxyCompactList}\item 
void \hyperlink{_m_p_u9150_8c_adb0eedc9c5b8538ab45234561338824f}{transformation\+\_\+mag} (float $\ast$values)
\begin{DoxyCompactList}\small\item\em Transformation for M\+PU values. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
X\+M\+C\+\_\+\+G\+P\+I\+O\+\_\+\+C\+O\+N\+F\+I\+G\+\_\+t \hyperlink{_m_p_u9150_8c_a8af7385d4430f2a52a33944e75b76dda}{i2c\+\_\+sda\+\_\+mpu}
\item 
X\+M\+C\+\_\+\+G\+P\+I\+O\+\_\+\+C\+O\+N\+F\+I\+G\+\_\+t \hyperlink{_m_p_u9150_8c_a1f31e316557e6fb374efe71d557b59c4}{i2c\+\_\+scl\+\_\+mpu}
\item 
X\+M\+C\+\_\+\+I2\+C\+\_\+\+C\+H\+\_\+\+C\+O\+N\+F\+I\+G\+\_\+t \hyperlink{_m_p_u9150_8c_a51fdd16f159d1e82e7c5c7445e1bf022}{i2c\+\_\+cfg\+\_\+mpu}
\item 
uint8\+\_\+t \hyperlink{_m_p_u9150_8c_a3842ef7e7823c37b07e3873e088f7df1}{Gscale} = \hyperlink{_m_p_u9150_8h_a56b5f26fc75e706b7513b8bac0006980a18297ef630f6920f812695549cc2262b}{G\+F\+S\+\_\+250\+D\+PS}
\item 
uint8\+\_\+t \hyperlink{_m_p_u9150_8c_a1b3bba16cabe134bc640926508ec94d3}{Ascale} = \hyperlink{_m_p_u9150_8h_a809d38a83bb0293b913cb890cafd82a8a93154da7a495cfb3b9ab29d2d5d4891b}{A\+F\+S\+\_\+2G}
\item 
float \hyperlink{_m_p_u9150_8c_a00dcba4fbbc703a15404c051f397721f}{a\+Res}
\item 
float \hyperlink{_m_p_u9150_8c_a307450bd86f46af27a40a489f873e9f6}{g\+Res}
\item 
float \hyperlink{_m_p_u9150_8c_ab80fbc567eaccc2870b5f3adf0a4ed04}{m\+Res}
\item 
int16\+\_\+t \hyperlink{_m_p_u9150_8c_a48f771d048650746960e9496ffe001e3}{acc\+Raw} \mbox{[}3\mbox{]}
\begin{DoxyCompactList}\small\item\em scale resolutions per L\+SB for the sensors \end{DoxyCompactList}\item 
int16\+\_\+t \hyperlink{_m_p_u9150_8c_a4d9c8729a5e996511b33700675fe994b}{gyro\+Raw} \mbox{[}3\mbox{]}
\item 
int16\+\_\+t \hyperlink{_m_p_u9150_8c_a87ec3a7b706cdb284c43edced845acd4}{mag\+Raw} \mbox{[}3\mbox{]}
\item 
float \hyperlink{_m_p_u9150_8c_aa71c43964fa7767f0461b2a0e0c0b151}{acc} \mbox{[}3\mbox{]} = \{0.\+0f\}
\item 
float \hyperlink{_m_p_u9150_8c_addac5578d412440de5e9c3760475dec7}{gyro} \mbox{[}3\mbox{]} = \{0.\+0f\}
\item 
float \hyperlink{_m_p_u9150_8c_a8bfde20656d3b3e853ffd2bacd794bc5}{mag} \mbox{[}3\mbox{]} = \{0.\+0f\}
\item 
float \hyperlink{_m_p_u9150_8c_a4d41bf736f1c2b22106e031a60ab3380}{mag\+Calibration} \mbox{[}3\mbox{]} = \{0.\+0f, 0.\+0f, 0.\+0f\}
\item 
float \hyperlink{_m_p_u9150_8c_ab21cc09df0e86cbca99e62e46e362334}{magbias} \mbox{[}3\mbox{]} = \{0.\+0f, 0.\+0f, 0.\+0f\}
\item 
float \hyperlink{_m_p_u9150_8c_acbffa34110f15b21994d3d087a0f4e7f}{q} \mbox{[}4\mbox{]} = \{1.\+0f, 0.\+0f, 0.\+0f, 0.\+0f\}
\begin{DoxyCompactList}\small\item\em Factory mag calibration and mag bias. \end{DoxyCompactList}\item 
float \hyperlink{_m_p_u9150_8c_a1bfaa14e96039bba6ec0de428d4eeff1}{e\+Int} \mbox{[}3\mbox{]} = \{0.\+0f, 0.\+0f, 0.\+0f\}
\begin{DoxyCompactList}\small\item\em vector to hold quaternion \end{DoxyCompactList}\item 
uint32\+\_\+t \hyperlink{_m_p_u9150_8c_a86a3ab105f11d2513678f38ea4e5ac1e}{last\+Update} = 0
\begin{DoxyCompactList}\small\item\em vector to hold integral error for Mahony method \end{DoxyCompactList}\item 
uint16\+\_\+t \hyperlink{_m_p_u9150_8c_af07e8900ae774f4274340f2ca15d7098}{counter\+Sensor} = 0
\begin{DoxyCompactList}\small\item\em used to calculate integration interval \end{DoxyCompactList}\item 
int \hyperlink{_m_p_u9150_8c_abf9ee789f7405a424a0b412257623cd0}{dcounter} = 0
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!Get\+Acc\+Data@{Get\+Acc\+Data}}
\index{Get\+Acc\+Data@{Get\+Acc\+Data}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{Get\+Acc\+Data(float $\ast$pt)}{GetAccData(float *pt)}}]{\setlength{\rightskip}{0pt plus 5cm}void Get\+Acc\+Data (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{pt}
\end{DoxyParamCaption}
)}\hypertarget{_m_p_u9150_8c_a05f6f2f09b0d64f157081650ac411271}{}\label{_m_p_u9150_8c_a05f6f2f09b0d64f157081650ac411271}


getter for acceleration data 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pt} & returned data gets written here\\
\hline
\end{DoxyParams}
returns the current data in a float\mbox{[}3\mbox{]} array \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!Get\+Angles@{Get\+Angles}}
\index{Get\+Angles@{Get\+Angles}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{Get\+Angles(float $\ast$angles)}{GetAngles(float *angles)}}]{\setlength{\rightskip}{0pt plus 5cm}void Get\+Angles (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{angles}
\end{DoxyParamCaption}
)}\hypertarget{_m_p_u9150_8c_affccf93aa2c7445f501003cb3c7ec823}{}\label{_m_p_u9150_8c_affccf93aa2c7445f501003cb3c7ec823}


calculates angles 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em angles} & pointer to the output\\
\hline
\end{DoxyParams}
calculates the angles with the selected algorithm \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!get\+Ares@{get\+Ares}}
\index{get\+Ares@{get\+Ares}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{get\+Ares(void)}{getAres(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void get\+Ares (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{_m_p_u9150_8c_a8576aaf6260747651cb99775519156d4}{}\label{_m_p_u9150_8c_a8576aaf6260747651cb99775519156d4}


sets Ares variable for calculating accelerometer value 

Function sets a global variable \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!get\+Gres@{get\+Gres}}
\index{get\+Gres@{get\+Gres}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{get\+Gres(void)}{getGres(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void get\+Gres (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{_m_p_u9150_8c_a03e83f5eaf88f5eb3a73d9c9179552ea}{}\label{_m_p_u9150_8c_a03e83f5eaf88f5eb3a73d9c9179552ea}


sets g\+Res variable for calculating gyro value 

Function sets a global variable \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!Get\+Gyro\+Data@{Get\+Gyro\+Data}}
\index{Get\+Gyro\+Data@{Get\+Gyro\+Data}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{Get\+Gyro\+Data(float $\ast$pt)}{GetGyroData(float *pt)}}]{\setlength{\rightskip}{0pt plus 5cm}void Get\+Gyro\+Data (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{pt}
\end{DoxyParamCaption}
)}\hypertarget{_m_p_u9150_8c_aa71d315bcdb1b9323329962a481a1490}{}\label{_m_p_u9150_8c_aa71d315bcdb1b9323329962a481a1490}


getter for gyro data 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pt} & returned data gets written here\\
\hline
\end{DoxyParams}
returns the current gyro data in degree in a float\mbox{[}3\mbox{]} array \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!Get\+Mag\+Data@{Get\+Mag\+Data}}
\index{Get\+Mag\+Data@{Get\+Mag\+Data}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{Get\+Mag\+Data(float $\ast$pt)}{GetMagData(float *pt)}}]{\setlength{\rightskip}{0pt plus 5cm}void Get\+Mag\+Data (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{pt}
\end{DoxyParamCaption}
)}\hypertarget{_m_p_u9150_8c_aba6353e685d53cdbbaaddba7390283c3}{}\label{_m_p_u9150_8c_aba6353e685d53cdbbaaddba7390283c3}


getter for magnetic data 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pt} & returned data gets written here\\
\hline
\end{DoxyParams}
writes the magnetometer values on the array with first position pt in a float\mbox{[}3\mbox{]} array \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!Get\+Sensor\+Count@{Get\+Sensor\+Count}}
\index{Get\+Sensor\+Count@{Get\+Sensor\+Count}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{Get\+Sensor\+Count(void)}{GetSensorCount(void)}}]{\setlength{\rightskip}{0pt plus 5cm}uint16\+\_\+t Get\+Sensor\+Count (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{_m_p_u9150_8c_ad139c70ad8fe17edf3bbbfa7f74db13e}{}\label{_m_p_u9150_8c_ad139c70ad8fe17edf3bbbfa7f74db13e}


getter for Sensor\+Count 

\begin{DoxyReturn}{Returns}
current value of Sensor\+Count
\end{DoxyReturn}
sensor count is a counter which gets elevated each time the mpu sends an interrupt \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!M\+P\+U9150\+\_\+\+Calibrate@{M\+P\+U9150\+\_\+\+Calibrate}}
\index{M\+P\+U9150\+\_\+\+Calibrate@{M\+P\+U9150\+\_\+\+Calibrate}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{M\+P\+U9150\+\_\+\+Calibrate(void)}{MPU9150_Calibrate(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void M\+P\+U9150\+\_\+\+Calibrate (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{_m_p_u9150_8c_ab2137323c677e007dc23af3982d0d70b}{}\label{_m_p_u9150_8c_ab2137323c677e007dc23af3982d0d70b}


calibrates the M\+PU 

Function which accumulates gyro and accelerometer data after device initialization. ~\newline
 It calculates the average of the at-\/rest readings and then loads the resulting offsets into accelerometer and gyro bias registers. \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!M\+P\+U9150\+\_\+\+Init@{M\+P\+U9150\+\_\+\+Init}}
\index{M\+P\+U9150\+\_\+\+Init@{M\+P\+U9150\+\_\+\+Init}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{M\+P\+U9150\+\_\+\+Init(void)}{MPU9150_Init(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void M\+P\+U9150\+\_\+\+Init (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{_m_p_u9150_8c_afad3e4f9d9238da5ffde49b155d9e457}{}\label{_m_p_u9150_8c_afad3e4f9d9238da5ffde49b155d9e457}


Initialises the M\+PU and configures gyro and accelerometer. 

wakes up device (enables all sensors and clears sleep mode bit)~\newline
Configures gyro and accelerometer (sets bandwith to 44 and 42 Hz, sample rate at 1 k\+Hz)~\newline
sets gyroscope full scale rage~\newline
sets accelerometer configuration~\newline
configures fifo~\newline
self tests magnetometer(\+W\+H\+O\+\_\+\+A\+M\+\_\+\+I register)~\newline
cofigures magnetometer for F\+I\+FO~\newline
configures interrupts and bypass enable \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!M\+P\+U9150\+\_\+\+Init\+A\+K8975A@{M\+P\+U9150\+\_\+\+Init\+A\+K8975A}}
\index{M\+P\+U9150\+\_\+\+Init\+A\+K8975A@{M\+P\+U9150\+\_\+\+Init\+A\+K8975A}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{M\+P\+U9150\+\_\+\+Init\+A\+K8975\+A(float $\ast$destination)}{MPU9150_InitAK8975A(float *destination)}}]{\setlength{\rightskip}{0pt plus 5cm}void M\+P\+U9150\+\_\+\+Init\+A\+K8975A (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{destination}
\end{DoxyParamCaption}
)}\hypertarget{_m_p_u9150_8c_a0c49498e2784ee40fe0d7b4766abbfdb}{}\label{_m_p_u9150_8c_a0c49498e2784ee40fe0d7b4766abbfdb}


initals 3 axis magnetometer 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em destination} & pointer on destinaton where to send the adjustment values\\
\hline
\end{DoxyParams}
returns the adjustment values for the 3 axis \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!M\+P\+U9150\+\_\+\+Self\+Test@{M\+P\+U9150\+\_\+\+Self\+Test}}
\index{M\+P\+U9150\+\_\+\+Self\+Test@{M\+P\+U9150\+\_\+\+Self\+Test}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{M\+P\+U9150\+\_\+\+Self\+Test(void)}{MPU9150_SelfTest(void)}}]{\setlength{\rightskip}{0pt plus 5cm}bool M\+P\+U9150\+\_\+\+Self\+Test (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{_m_p_u9150_8c_a80e8e31ece39826744afca452c8f84f4}{}\label{_m_p_u9150_8c_a80e8e31ece39826744afca452c8f84f4}


Self test for the M\+PU. 

\begin{DoxyReturn}{Returns}
returns true if passed and false if not
\end{DoxyReturn}
Should return percent deviation from factory trim values, +/-\/ 14 or less deviation is a pass \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!M\+P\+U9150\+\_\+\+Setup@{M\+P\+U9150\+\_\+\+Setup}}
\index{M\+P\+U9150\+\_\+\+Setup@{M\+P\+U9150\+\_\+\+Setup}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{M\+P\+U9150\+\_\+\+Setup(void)}{MPU9150_Setup(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void M\+P\+U9150\+\_\+\+Setup (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{_m_p_u9150_8c_aa9d3f4102d6c3dacb07fd0da57a649cb}{}\label{_m_p_u9150_8c_aa9d3f4102d6c3dacb07fd0da57a649cb}


gets increased when the mpu sends new data 

M\+PU I2C setup and selftests

Sets up I2C F\+I\+FO~\newline
makes a selftest through reading the W\+H\+O\+\_\+\+A\+M\+\_\+I register~\newline
\index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!M\+P\+U9\+X50\+\_\+\+Ext\+\_\+\+Int\+\_\+\+I\+SR@{M\+P\+U9\+X50\+\_\+\+Ext\+\_\+\+Int\+\_\+\+I\+SR}}
\index{M\+P\+U9\+X50\+\_\+\+Ext\+\_\+\+Int\+\_\+\+I\+SR@{M\+P\+U9\+X50\+\_\+\+Ext\+\_\+\+Int\+\_\+\+I\+SR}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{M\+P\+U9\+X50\+\_\+\+Ext\+\_\+\+Int\+\_\+\+I\+S\+R(void)}{MPU9X50_Ext_Int_ISR(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void M\+P\+U9\+X50\+\_\+\+Ext\+\_\+\+Int\+\_\+\+I\+SR (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{_m_p_u9150_8c_a2ae2ee3ce9369114b232aba97d813ddd}{}\label{_m_p_u9150_8c_a2ae2ee3ce9369114b232aba97d813ddd}


Interrupt service routine of the externel M\+PU interrupt. 

gets called when the mpu has new data and sets the interrupt pin~\newline
reads in the raw data and processes it \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!transformation@{transformation}}
\index{transformation@{transformation}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{transformation(float $\ast$values)}{transformation(float *values)}}]{\setlength{\rightskip}{0pt plus 5cm}void transformation (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{values}
\end{DoxyParamCaption}
)}\hypertarget{_m_p_u9150_8c_a812d10f594dfdeeab08734a739102717}{}\label{_m_p_u9150_8c_a812d10f594dfdeeab08734a739102717}


Transformation for M\+PU values. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em values} & Parameter\+\_\+\+Description\\
\hline
\end{DoxyParams}
Transforms the positioning from Prototype P\+CP to the Larix P\+CB \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!transformation\+\_\+mag@{transformation\+\_\+mag}}
\index{transformation\+\_\+mag@{transformation\+\_\+mag}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{transformation\+\_\+mag(float $\ast$values)}{transformation_mag(float *values)}}]{\setlength{\rightskip}{0pt plus 5cm}void transformation\+\_\+mag (
\begin{DoxyParamCaption}
\item[{float $\ast$}]{values}
\end{DoxyParamCaption}
)}\hypertarget{_m_p_u9150_8c_adb0eedc9c5b8538ab45234561338824f}{}\label{_m_p_u9150_8c_adb0eedc9c5b8538ab45234561338824f}


Transformation for M\+PU values. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em values} & Parameter\+\_\+\+Description\\
\hline
\end{DoxyParams}
Transforms the positioning from Prototype P\+CP to the Larix P\+CB 

\subsection{Variable Documentation}
\index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!acc@{acc}}
\index{acc@{acc}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{acc}{acc}}]{\setlength{\rightskip}{0pt plus 5cm}float acc\mbox{[}3\mbox{]} = \{0.\+0f\}}\hypertarget{_m_p_u9150_8c_aa71c43964fa7767f0461b2a0e0c0b151}{}\label{_m_p_u9150_8c_aa71c43964fa7767f0461b2a0e0c0b151}
corrected and usefull accelerometer data \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!acc\+Raw@{acc\+Raw}}
\index{acc\+Raw@{acc\+Raw}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{acc\+Raw}{accRaw}}]{\setlength{\rightskip}{0pt plus 5cm}int16\+\_\+t acc\+Raw\mbox{[}3\mbox{]}}\hypertarget{_m_p_u9150_8c_a48f771d048650746960e9496ffe001e3}{}\label{_m_p_u9150_8c_a48f771d048650746960e9496ffe001e3}


scale resolutions per L\+SB for the sensors 

raw data from accelerometer \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!a\+Res@{a\+Res}}
\index{a\+Res@{a\+Res}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{a\+Res}{aRes}}]{\setlength{\rightskip}{0pt plus 5cm}float a\+Res}\hypertarget{_m_p_u9150_8c_a00dcba4fbbc703a15404c051f397721f}{}\label{_m_p_u9150_8c_a00dcba4fbbc703a15404c051f397721f}
\index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!Ascale@{Ascale}}
\index{Ascale@{Ascale}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{Ascale}{Ascale}}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t {\bf Ascale} = {\bf A\+F\+S\+\_\+2G}}\hypertarget{_m_p_u9150_8c_a1b3bba16cabe134bc640926508ec94d3}{}\label{_m_p_u9150_8c_a1b3bba16cabe134bc640926508ec94d3}
Scale range of accelerometer \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!counter\+Sensor@{counter\+Sensor}}
\index{counter\+Sensor@{counter\+Sensor}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{counter\+Sensor}{counterSensor}}]{\setlength{\rightskip}{0pt plus 5cm}uint16\+\_\+t counter\+Sensor = 0}\hypertarget{_m_p_u9150_8c_af07e8900ae774f4274340f2ca15d7098}{}\label{_m_p_u9150_8c_af07e8900ae774f4274340f2ca15d7098}


used to calculate integration interval 

\index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!dcounter@{dcounter}}
\index{dcounter@{dcounter}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{dcounter}{dcounter}}]{\setlength{\rightskip}{0pt plus 5cm}int dcounter = 0}\hypertarget{_m_p_u9150_8c_abf9ee789f7405a424a0b412257623cd0}{}\label{_m_p_u9150_8c_abf9ee789f7405a424a0b412257623cd0}
\index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!e\+Int@{e\+Int}}
\index{e\+Int@{e\+Int}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{e\+Int}{eInt}}]{\setlength{\rightskip}{0pt plus 5cm}float e\+Int\mbox{[}3\mbox{]} = \{0.\+0f, 0.\+0f, 0.\+0f\}}\hypertarget{_m_p_u9150_8c_a1bfaa14e96039bba6ec0de428d4eeff1}{}\label{_m_p_u9150_8c_a1bfaa14e96039bba6ec0de428d4eeff1}


vector to hold quaternion 

\index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!g\+Res@{g\+Res}}
\index{g\+Res@{g\+Res}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{g\+Res}{gRes}}]{\setlength{\rightskip}{0pt plus 5cm}float g\+Res}\hypertarget{_m_p_u9150_8c_a307450bd86f46af27a40a489f873e9f6}{}\label{_m_p_u9150_8c_a307450bd86f46af27a40a489f873e9f6}
\index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!Gscale@{Gscale}}
\index{Gscale@{Gscale}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{Gscale}{Gscale}}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t {\bf Gscale} = {\bf G\+F\+S\+\_\+250\+D\+PS}}\hypertarget{_m_p_u9150_8c_a3842ef7e7823c37b07e3873e088f7df1}{}\label{_m_p_u9150_8c_a3842ef7e7823c37b07e3873e088f7df1}
Scale range of gyro \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!gyro@{gyro}}
\index{gyro@{gyro}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{gyro}{gyro}}]{\setlength{\rightskip}{0pt plus 5cm}float gyro\mbox{[}3\mbox{]} = \{0.\+0f\}}\hypertarget{_m_p_u9150_8c_addac5578d412440de5e9c3760475dec7}{}\label{_m_p_u9150_8c_addac5578d412440de5e9c3760475dec7}
corrected and usefull gyro data \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!gyro\+Raw@{gyro\+Raw}}
\index{gyro\+Raw@{gyro\+Raw}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{gyro\+Raw}{gyroRaw}}]{\setlength{\rightskip}{0pt plus 5cm}int16\+\_\+t gyro\+Raw\mbox{[}3\mbox{]}}\hypertarget{_m_p_u9150_8c_a4d9c8729a5e996511b33700675fe994b}{}\label{_m_p_u9150_8c_a4d9c8729a5e996511b33700675fe994b}
raw data from gyroscope \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!i2c\+\_\+cfg\+\_\+mpu@{i2c\+\_\+cfg\+\_\+mpu}}
\index{i2c\+\_\+cfg\+\_\+mpu@{i2c\+\_\+cfg\+\_\+mpu}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{i2c\+\_\+cfg\+\_\+mpu}{i2c_cfg_mpu}}]{\setlength{\rightskip}{0pt plus 5cm}X\+M\+C\+\_\+\+I2\+C\+\_\+\+C\+H\+\_\+\+C\+O\+N\+F\+I\+G\+\_\+t i2c\+\_\+cfg\+\_\+mpu}\hypertarget{_m_p_u9150_8c_a51fdd16f159d1e82e7c5c7445e1bf022}{}\label{_m_p_u9150_8c_a51fdd16f159d1e82e7c5c7445e1bf022}
{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
  .baudrate = 400000U,  
\}
\end{DoxyCode}
\index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!i2c\+\_\+scl\+\_\+mpu@{i2c\+\_\+scl\+\_\+mpu}}
\index{i2c\+\_\+scl\+\_\+mpu@{i2c\+\_\+scl\+\_\+mpu}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{i2c\+\_\+scl\+\_\+mpu}{i2c_scl_mpu}}]{\setlength{\rightskip}{0pt plus 5cm}X\+M\+C\+\_\+\+G\+P\+I\+O\+\_\+\+C\+O\+N\+F\+I\+G\+\_\+t i2c\+\_\+scl\+\_\+mpu}\hypertarget{_m_p_u9150_8c_a1f31e316557e6fb374efe71d557b59c4}{}\label{_m_p_u9150_8c_a1f31e316557e6fb374efe71d557b59c4}
{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
  .mode = XMC\_GPIO\_MODE\_OUTPUT\_OPEN\_DRAIN\_ALT1,         
  .output\_strength = XMC\_GPIO\_OUTPUT\_STRENGTH\_MEDIUM    
\}
\end{DoxyCode}
\index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!i2c\+\_\+sda\+\_\+mpu@{i2c\+\_\+sda\+\_\+mpu}}
\index{i2c\+\_\+sda\+\_\+mpu@{i2c\+\_\+sda\+\_\+mpu}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{i2c\+\_\+sda\+\_\+mpu}{i2c_sda_mpu}}]{\setlength{\rightskip}{0pt plus 5cm}X\+M\+C\+\_\+\+G\+P\+I\+O\+\_\+\+C\+O\+N\+F\+I\+G\+\_\+t i2c\+\_\+sda\+\_\+mpu}\hypertarget{_m_p_u9150_8c_a8af7385d4430f2a52a33944e75b76dda}{}\label{_m_p_u9150_8c_a8af7385d4430f2a52a33944e75b76dda}
{\bfseries Initial value\+:}
\begin{DoxyCode}
=
\{
  .mode =   XMC\_GPIO\_MODE\_OUTPUT\_OPEN\_DRAIN\_ALT1,       
  .output\_strength = XMC\_GPIO\_OUTPUT\_STRENGTH\_MEDIUM    
\}
\end{DoxyCode}
\index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!last\+Update@{last\+Update}}
\index{last\+Update@{last\+Update}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{last\+Update}{lastUpdate}}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t last\+Update = 0}\hypertarget{_m_p_u9150_8c_a86a3ab105f11d2513678f38ea4e5ac1e}{}\label{_m_p_u9150_8c_a86a3ab105f11d2513678f38ea4e5ac1e}


vector to hold integral error for Mahony method 

\index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!mag@{mag}}
\index{mag@{mag}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{mag}{mag}}]{\setlength{\rightskip}{0pt plus 5cm}float mag\mbox{[}3\mbox{]} = \{0.\+0f\}}\hypertarget{_m_p_u9150_8c_a8bfde20656d3b3e853ffd2bacd794bc5}{}\label{_m_p_u9150_8c_a8bfde20656d3b3e853ffd2bacd794bc5}
corrected and usefull magnetometer data \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!magbias@{magbias}}
\index{magbias@{magbias}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{magbias}{magbias}}]{\setlength{\rightskip}{0pt plus 5cm}float magbias\mbox{[}3\mbox{]} = \{0.\+0f, 0.\+0f, 0.\+0f\}}\hypertarget{_m_p_u9150_8c_ab21cc09df0e86cbca99e62e46e362334}{}\label{_m_p_u9150_8c_ab21cc09df0e86cbca99e62e46e362334}
\index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!mag\+Calibration@{mag\+Calibration}}
\index{mag\+Calibration@{mag\+Calibration}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{mag\+Calibration}{magCalibration}}]{\setlength{\rightskip}{0pt plus 5cm}float mag\+Calibration\mbox{[}3\mbox{]} = \{0.\+0f, 0.\+0f, 0.\+0f\}}\hypertarget{_m_p_u9150_8c_a4d41bf736f1c2b22106e031a60ab3380}{}\label{_m_p_u9150_8c_a4d41bf736f1c2b22106e031a60ab3380}
\index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!mag\+Raw@{mag\+Raw}}
\index{mag\+Raw@{mag\+Raw}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{mag\+Raw}{magRaw}}]{\setlength{\rightskip}{0pt plus 5cm}int16\+\_\+t mag\+Raw\mbox{[}3\mbox{]}}\hypertarget{_m_p_u9150_8c_a87ec3a7b706cdb284c43edced845acd4}{}\label{_m_p_u9150_8c_a87ec3a7b706cdb284c43edced845acd4}
raw data from magnetometer \index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!m\+Res@{m\+Res}}
\index{m\+Res@{m\+Res}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{m\+Res}{mRes}}]{\setlength{\rightskip}{0pt plus 5cm}float m\+Res}\hypertarget{_m_p_u9150_8c_ab80fbc567eaccc2870b5f3adf0a4ed04}{}\label{_m_p_u9150_8c_ab80fbc567eaccc2870b5f3adf0a4ed04}
\index{M\+P\+U9150.\+c@{M\+P\+U9150.\+c}!q@{q}}
\index{q@{q}!M\+P\+U9150.\+c@{M\+P\+U9150.\+c}}
\subsubsection[{\texorpdfstring{q}{q}}]{\setlength{\rightskip}{0pt plus 5cm}float q\mbox{[}4\mbox{]} = \{1.\+0f, 0.\+0f, 0.\+0f, 0.\+0f\}}\hypertarget{_m_p_u9150_8c_acbffa34110f15b21994d3d087a0f4e7f}{}\label{_m_p_u9150_8c_acbffa34110f15b21994d3d087a0f4e7f}


Factory mag calibration and mag bias. 

