<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Larix_Flightcontroller: LARIX Flight-Controller</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Larix_Flightcontroller
   &#160;<span id="projectnumber">V1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">LARIX Flight-Controller </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#support">Supported devices and toolchains</a></li>
<li class="level1"><a href="#overview">Overview</a></li>
<li class="level1"><a href="#moduleDescription">Module Description</a></li>
<li class="level1"><a href="#interrupts">Interrupts at LARIX Flight-Controller software</a></li>
</ul>
</div>
<div class="textblock"><div class="image">
<img src="QuadroMainpage.jpg" alt="QuadroMainpage.jpg"/>
</div>
 <p>The LARIX Flight-Controller is the Flight-Controller software for the LARIX Quadrocopter Demonstrator.<br />
 Built on top the DAVE4 Apps and XMC library it provides an easy to configure solution which can be easily modified.<br />
</p>
<h1><a class="anchor" id="support"></a>
Supported devices and toolchains</h1>
<p>The following 32-Bit Industrial Microcontrollers based on ARM Cortex-M4F are supported:</p><ul>
<li>XMC4500 series</li>
</ul>
<p>The following tool chains are supported:</p><ul>
<li>GNU GCC for ARM (gcc) found in DAVE4.</li>
</ul>
<h1><a class="anchor" id="overview"></a>
Overview</h1>
<p>Main function of this piece of software is to collect the data of the user input:</p><ul>
<li>Bluetooth (RN42) or</li>
<li>RC-Receiver (DSMX-Spektrum) <br />
</li>
</ul>
<p>and the internal sensors:</p><ul>
<li>MPU9X50 (Inertial Measurement Unit)</li>
<li>DPS310 (Precision pressure sensor)</li>
</ul>
<p>to calculate and transmit needed speed of motors so that a stable flight is ensured. <br />
</p>
<p>The LARIX-Flight Controller Software consists of several files all stored at the _Quadrocopter folder. <br />
 Within this _Quadrocopter folder you find several subfolders, which represent nearly independent modules <br />
 that are built on top of DAVE4 Apps, the XMC Library and a rudimentary Harware Abstraction Layer. <br />
</p>
<p>The software is interrupt driven which means every sensor and the control interrupt is caused by <br />
 it's individual interrupt source which could be a timer or an external interrupt that is triggered by the <br />
 sensor itself. Detailed information for each Interrupt and the corresponding service routine can be found at the<br />
 end of this document. <br />
</p>
<p>A debug interface is given via uC Probe: <a href="http://www.infineon.com/cms/de/product/microcontroller/development-tools-software-and-kits/dave-version-4-free-development-platform-for-code-generation/uc-probe-xmc-for-industrial-mcu/channel.html?channel=5546d46254e133b40154f34038fe1620#ispnTab1">uC Probe</a> <br />
 or via a VCOM Port provided by a USB interface which is configured and used via USB_VCOM App.</p>
<p>More details on hard- and software of the LARIX Quadrocopter Demonstrator can be found at:</p><ul>
<li><a href="https://github.com/ManagementCenterInnsbruck/InfineonMulticopter_LARIX/wiki">https://github.com/ManagementCenterInnsbruck/InfineonMulticopter_LARIX/wiki</a></li>
<li><a href="http://www.infineon.com/cms/en/applications/consumer/multicopters/">http://www.infineon.com/cms/en/applications/consumer/multicopters/</a></li>
</ul>
<h1><a class="anchor" id="moduleDescription"></a>
Module Description</h1>
<p><b> Folder Structure: </b> </p><div class="image">
<img src="FolderStructure.PNG" alt="FolderStructure.PNG"/>
</div>
 <ul>
<li>_FIR_Filter<br />
 This module provides a simple implementation of a finite impulse response filter. <br />
 It is used for filtering the pressure data provided by the DPS310.</li>
<li>_HAL<br />
 This module builds the basis for serial communication via<br />
 UART and I2C and holds the files for a delay function.<br />
 In addition it contains the file GPIO.h which provides an easy way to control<br />
 the digital pins of the controller.</li>
<li>Attitude_Control<br />
 This module holds the control algorithms for the Quadrocopter.<br />
 In addition it contains the function for scaling the output values of the control algorithm to the input values of the electric speed controllers(ESC's).<br />
</li>
<li>BatterySafety<br />
 This module contains the software for battery monitoring.<br />
 It shows battery status via three status LED's that are mounted at<br />
 the LARIX board.</li>
<li>DaisyChain<br />
 This module provides functions to transmit data using an UART DaisyChain which connects the flight controller<br />
 with the ESC's. The possibility to add feedback data from the ESC's is given, but is not implemented.</li>
<li>RemoteControl<br />
 This module contains the software for receiving the steering data of the user.<br />
 The two supported ways of communication are Bluetooth(RN-42 module)<br />
 and 2.4GHz Radio(Spektrum DSMX Receiver, Spektrum DX6i transmitter).<br />
 A Bluetooth-Only mode can be configured via a #define at the <a class="el" href="_r_c_receive_8h.html">RCReceive.h</a></li>
<li>Sensors<br />
 This module contains the software for configuring, reading and interpreting the<br />
 values of both the DPS310 pressure sensor and the MPU9X50 Inertial Measurement Unit(IMU). Both are signaling new values<br />
 by triggering external interrupts.</li>
</ul>
<h1><a class="anchor" id="interrupts"></a>
Interrupts at LARIX Flight-Controller software</h1>
<p>Like described at the section overview the LARIX Flight-Controller software<br />
 is an interrupt driven software. This means a set of functions exists, which are executed when<br />
 a specific event triggers an interrupt.<br />
 It is important to know that these functions can be interrupted by each other depending on their<br />
 priority. Priority 0 is the highest priority while 63 is the last priority that can be given<br />
 to an interrupt function.<br />
 At Dave4 Interrupts are handled via INTERRUPT App.<br />
</p>
<p>LARIX Flight-Controller software uses global variables to communicate with other interrupt routines.<br />
 It is important to note that every variable, which is used by more than one interrupt is only allowed to be directly<br />
 manipulated by one interrupt. Every other interrupt which wants to use the data stored at these globals<br />
 has to make a local copy of the global one. This is done to avoid unwanted change of global variables<br />
 which would influence stability of the other software modules.</p>
<p>The next table shows all independent interrupt routines and their purpose. <br />
</p>
<a class="anchor" id="multi_row"></a>
<table class="doxtable">
<caption>Interrupt Overview</caption>
<tr>
<th>Number </th><th>Interrupt Service Routine </th><th>Priority </th><th>Event </th><th>Description </th><th>Found at </th></tr>
<tr>
<th>1 </th><th>Util_Timer_ISR </th><th>2 </th><th>Triggered by Utils_Timer(1 kHz) </th><th>Builds the basis of delay function </th><th>./_HAL/Delay/util.c </th></tr>
<tr>
<th>2 </th><th>Control_Timer_ISR </th><th>5 </th><th>Triggered by Control_Timer(100 Hz) </th><th>Contains the Control Algorithm for Quadcopter </th><th>./Attitude_Control/AttitudeController.c </th></tr>
<tr>
<th>3 </th><th>RemoteControl_RX_ISR </th><th>7 </th><th>32 Bytes of data are received at UART for RC </th><th>Data gets read out and interpreted to new desired values </th><th>./RemoteControl/RCReceive.c </th></tr>
<tr>
<th>4 </th><th>Bluetooth_RX_ISR </th><th>8 </th><th>19 Bytes of data are received at UART for Bluetooth </th><th>Data gets read out and interpreted to new desired values </th><th>./RemoteControl/RCReceive.c </th></tr>
<tr>
<th>5 </th><th>MPU9X50_Ext_Int_ISR </th><th>10 </th><th>Rising Edge on P0.5 detected </th><th>Data gets read and new orientation is calculated </th><th>./Sensors/MPU9X50/MPU9150.c </th></tr>
<tr>
<th>6 </th><th>DPS310_EXT_INT_ISR </th><th>12 </th><th>Falling Edge on P1.15 detected </th><th>Data gets read out and interpreted to new pressure value </th><th>./Sensors/DPS310/DPS310.c </th></tr>
<tr>
<th>7 </th><th>WatchRC </th><th>17 </th><th>Triggered by RC Watch Timer(5 Hz) </th><th>check if new value from RC or Bluetooth -&gt; timeoutflag </th><th>./RemoteControl/RCReceive.c </th></tr>
<tr>
<th>8 </th><th>GeneralPurpose_Timer_Bluetooth_Keep_Alive_ISR </th><th>20 </th><th>Triggered by General Purpose Timer(1 Hz) </th><th>Sends keep alive message for Android app </th><th>./RemoteControl/RCReceive.c </th></tr>
<tr>
<th>9 </th><th>VBat_Measurement_ISR </th><th>30 </th><th>ADC Conversion of Battery Voltage finished </th><th>Voltage is read out of register and displayed trough LEDs </th><th>./BatterySafety/BatterySafety.c </th></tr>
<tr>
<th>10 </th><th>MagnetometerCal_Timer_ISR </th><th>63 </th><th>Triggered by MagnetometerCal_Timer(10 Hz) </th><th>Not implemented </th><th>*_______________________________* </th></tr>
<tr>
<th>11 </th><th>DaisyChain_RX_ISR </th><th>63 </th><th>should be triggered when 13Bytes of Data are received at Daisy Uart </th><th>Not implemented </th><th>*_______________________________* </th></tr>
</table>
<p><br />
</p>
<p>To give a better overview of this table the image under this text was created.<br />
 Keep in mind that this picture's purpose is to give an overview but not an exact representation of<br />
 the Software.<br />
</p>
<p><b>Simple Flow-Chart</b></p>
<div align="center">
<img src="dot_inline_dotgraph_1.png" alt="dot_inline_dotgraph_1.png" border="0" usemap="#dot_inline_dotgraph_1.map"/>
<map name="dot_inline_dotgraph_1.map" id="dot_inline_dotgraph_1.map"></map>
</div>
<p> <br />
</p>
<p><br />
 <br />
 <br />
 <br />
 </p>
<p><b> License Terms and Copyright Information </b></p>
<p>Copyright (c) 2015, Infineon Technologies AG All rights reserved.</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p><ul>
<li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li>
<li>Neither the name of the copyright holders nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</li>
</ul>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
<p>To improve the quality of the software, users are encouraged to share modifications, enhancements or bug fixes with Infineon Technologies AG (<a href="#" onclick="location.href='mai'+'lto:'+'sup'+'po'+'rt@'+'in'+'fin'+'eo'+'n.c'+'om'; return false;">suppo<span style="display: none;">.nosp@m.</span>rt@i<span style="display: none;">.nosp@m.</span>nfine<span style="display: none;">.nosp@m.</span>on.c<span style="display: none;">.nosp@m.</span>om</a>).</p>
<p><b>Legal Disclaimer</b> The information given in this document shall in no event be regarded as a guarantee of conditions or characteristics. With respect to any examples or hints given herein, any typical values stated herein and/or any information regarding the application of the device, Infineon Technologies hereby disclaims any and all warranties and liabilities of any kind, including without limitation, warranties of non-infringement of intellectual property rights of any third party.</p>
<p><b>Information</b> For further information on technology, delivery terms and conditions and prices, please contact the nearest Infineon Technologies Office (www.infineon.com).</p>
<p><b>Warnings</b> Due to technical requirements, components may contain dangerous substances. For information on the types in question, please contact the nearest Infineon Technologies Office. Infineon Technologies components may be used in life-support devices or systems only with the express written approval of Infineon Technologies, if a failure of such components can reasonably be expected to cause the failure of that life-support device or system or to affect the safety or effectiveness of that device or system. Life support devices or systems are intended to be implanted in the human body or to support and/or maintain and sustain and/or protect human life. If they fail, it is reasonable to assume that the health of the user or other persons may be endangered. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
